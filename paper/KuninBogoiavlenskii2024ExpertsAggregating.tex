\documentclass[12pt, twoside]{article}
\usepackage{jmlda}
\newcommand{\hdir}{.}



\begin{document}

\English

\title
	[My first scientific paper] % short title for page headings, not necessary if a full title fits the headings
    {Influence of hyperparameters on aggregating predictions of infinite number of experts} % full title
\author
	[S.\,M.~Kunin-Bogoiavlenskii] % short list of the authors (<= 3) for page headings, is necessary only if the full list does not fit the headings
%S.M. Kunin-Bogoiavlenskii, A.V. Zukhba, and R.D. Zukhba
	{S.\,M.~Kunin-Bogoiavlenskii, A.\,V.~Zukhba, R.\,D.~Zukhba, and V.\,V.~V’yugin} % full list of the authors, presented in the table of contetns of the issue
    [S.\,M.~Kunin-Bogoiavlenskii, A.\,V.~Zukhba] % list of the authors presented in the title page of the article, is necessary only if it differs from the full list of the authors in braces, i.e. '{' and '}'
\email
    {kunin-bogoiavlenskii.sm@phystech.edu; a\_\_l@mail.ru}
%\thanks
%    {The research was
%     %partially
%     supported by the Russian Foundation for Basic Research (grants 00-00-0000 and 00-00-00001).}
\organization
    {Moscow Insitute of Physics and Technology}
\abstract
    {
    
	Using aggregation of expert forecasts is one of the important methods to improve prediction accuracy. 
	This paper focuses on examining the influence of hyperparameters on the accuracy of the aggregation algorithm with an infinite number of experts.
	We implemented a time series generator with specified properties and an aggregating forecasting model. 
	We conducted a series of experiments with various hyperparameters of the algorithm.
	Finding optimal hyperparameters leads to high performance and wider adoption of this prediction method.
	    	
%	\noindent
%	\textbf{Background}:	One paragraph about the problem, existent approaches and its limitations.
%	
%	\noindent
%	\textbf{Methods}: One paragraph about proposed method and its novelty.
%	
%	\noindent
%	\textbf{Results}: One paragraph about major properties of the proposed method and experiment results if applicable.
%	
%	\noindent
%	\textbf{Concluding Remarks}: One paragraph about the place of the proposed method among existent approaches.
%				
	\noindent
    	\textbf{Keywords}: \emph{online learning; aggregating algorithm; prediction with experts’ advice; Fixed Share, Mixing Past Posteriors (MPP)}}

%these fields are filled in by the journal editors
%\doi{10.21469/22233792}
%\receivedRus{01.01.2017}
\receivedEng{January 01, 2017}

\maketitle
%\linenumbers

\section{Introduction}
%\noindent %this command is placed at the beginning of the first sentence of each paragraph/section only.
This work is inspired by the algorithm, developed in the article \cite{article}, considering online game of prediction with experts' advice. The data is presented as a time series, consisting of outcome pairs --- <<signal>> and <<response>>. 
In contrast to the classical statistical theory of sequential prediction, we made no assumptions about the nature of the data (which could be deterministic, stochastic, etc.). 
We used machine learning methods to build forecasters within a game-theoretic approach.
The online learning master model considers a series of reference forecasters, referred to as experts, to build its opinion by combining their predictions.


%\noindent
The general prediction algorithm with expert advice follows this structure:
Learning progresses in trials at discrete points in time. 
During each step , expert models, based on past observational data subsamples, provide their predictions. 
The master model then makes a decision using the chosen aggregating algorithm. 
At the end of the trial, the generator presents the true outcome, and both the master and expert models are scored using a loss function. 
The difference between the master's cumulative losses and the expert's cumulative losses is defined as regret.
The traditional goal of the aggregating algorithm is to keep it as small as possible.

%\noindent
We use special assumptions about the data generation structure when building forecasting strategies. It is assumed that there are multiple generators, whose structure is unknown to the predictors. These generators switch, producing a time series that is subdivided into a sequence of segments - areas of stationarity, which can be studied using machine learning methods. Each corresponding local predictive model will be constructed based on data from the area of stationarity and can be then successfully applied in other areas of stationarity generated by the same generator.

%\noindent
In this formulation of the forecasting problem, the series of prediction steps is divided into segments that frame arbitrary sequences of expert strategies. The sequence of segments and its associated sequence of experts is called a partition. The modified goal of the aggregating algorithm is to perform well relative to the best partition. Accordingly, the new concept of algorithm regret is the difference between the algorithm's losses and the cumulative losses of the sequence of experts. This change allows for a more accurate modeling of real-life conditions, where the nature of outcomes may change over time and different experts may predict with varying degrees of success depending on the current trend. 

%\noindent
The corresponding algorithm is called Fixed Share \cite{article98}. A further proposed generalization of it is the Mixing Past Posteriors (MPP) method \cite{article02}. The cumulative losses of the aggregating algorithm are related to convex combinations of expert losses. The concept of regret also changes. Now the algorithm's cumulative losses are compared to the cumulative losses of convex combinations of expert strategies.

A characteristic feature of the problem considered in \cite{article} is the absence of a predefined set of competing expert strategies, as was the case in the works cited above. Instead, new expert strategies are constructed at each step of the online learning process. The master must aggregate the forecasts of all expert strategies constructed up to that time in real-time at each step. Algorithm GMPP, proposed in \cite{article}, is the foundation of our experiments. 

\section{Problem statement}
\paragraph{Definitions}
Let $x_1, x_2, \dots$ be the sequence of signals belonging to the sample space  $\mathsf{X}$. 
The forecaster's goal is to predict the sequence of the corresponding responces $y_1, y_2, \dots$ belonging to the outcome space $\mathsf{Y}$. 
We assume that there is an infinite number of experts $i \in \mathcal{N}$, where $\mathcal{N}$ is the natural numbers set. 
The predictions of the master and experts belong to the decision space $\mathsf{D}$. 
Let $ \lambda: \mathsf{D} \times \mathsf{Y} \rightarrow \RR_+$ be the nonnegative loss function. 

At each step $t$ every expert $i \in \mathcal{N}$ provides his prediction $f_t^i = f_t^i(x_t)  \in \mathsf{D}$. 
After obtaining them the master gives his prediction $p_t = p_t(x_t) \in \mathsf{D}$. 
Next, the generator reveals the true outcome $y_t$, and the losses are computed.
Let $l_t^i = \lambda(f_t^i, y_t)$ be the loss of expert $i$, and $h_t = \lambda(p_t, y_t)$ be the master's loss 

Using designations $L_T^i = \sum_{t = 1}^T l_t^i$ --- the cumulative loss of expert $i$ during the first T steps, and $H_T = \sum_{t = 1}^T h_t$ --- the master's cumulative loss during the first T steps, we can define the master's regret relative to the expert $i$ as $R^i_t = H_T - L^i_T$
\paragraph{Data generator}
 
\paragraph{Algorithm GMPP}
\textbf{Initialization}: Initialize the weights $w^i_1$ so that $\sum_{i \in \mathcal{N}}w^i_1 = 1$

\textbf{FOR} $t = 1, 2, \dots$:
\begin{enumerate}[leftmargin=4em]
\item Initialize expert $f^t$
\item Receive signal $x_t$ from the generator 
\item Get experts' predictions $f_t^i = f_t^i(x_t), 1 \le i \le t$ 
\item Compute normalized weights of experts  $1 \le i \le t$: $$\widehat{w}^i_t = \dfrac{w^i_t}{\sum_{j=1}^t w_t^j}$$
\item Evaluate master's prediction $\gamma_t = \mathsf{Subst}(\mathbf{f_t}, \mathbf{\widehat{w}_t})$, \\ where $\mathbf{\widehat{w}_t} = (\widehat{w}_t^1, \widehat{w}_t^2, \dots \widehat{w}_t^t),\ \mathbf{f_t} = (f_t^1, f_t^2, \dots f_t^t)$
\item Generator reveals true outcome $y_t$
\item Compuste master's loss $h_t = \lambda(p_t, y_t) $ and experts' losses: $l_t^i =
\begin{cases}
        \lambda(f_t^i, y_t), & \text{if $i \le t$} \\
        h_t, & \text{if $i > t$}
\end{cases}$
%\item Modify experts' weights in two steps:

\item \textbf{Loss Update} weights modification
\[  \widetilde{w}_t^i = \dfrac{w_t^i e^{\eta l_t^i}}{\sum\limits_{j = 1}^t w_t^j e^{-\eta l_t^i} + e^{-\eta h_t} (1 - \sum\limits_{j = 1}^t w_t^j) } \]
\item \textbf{Mixing Update} weights modification
\[  \widetilde{w}_{t+1}^i = \alpha_t\widetilde{w}_1^i + (1 - \alpha_t\widetilde{w}_t^i)\] 
\end{enumerate}

\textbf{ENDFOR}

\bigskip
It was proved in \cite{article} that for $\alpha = \frac1{t + 1}$ and any partition of $k+1$ experts, the following is true  (where $L_T(E)$ is the cumulative loss of partition $E$) :
\[ \limsup_{T \to \infty} \dfrac{H_T - L_T(E)}{T} = 0\] 

This allows formulating the main assumption underlying the application of the GMPP algorithm: In cases where it is possible to <<attach>> a valid predictive (expert) strategy to each local sub-sample from the generation area, carrying small losses on each local sub-sample generated by the generator, i.e., <<learn>> this generator, the GMPP algorithm will also predict with sufficiently small losses on the entire sample.

% \begin{aligned} \begin{cases}



%\begin{equation}
%    \begin{cases}
%      k_{i\omega}/k_{p\omega}=2\pi\times 10\\
%      \left\lvert\frac{k_{p\omega}s+k_{i\omega}}{s}\cdot\frac{1}{Ts+1}\right\rvert_{S=\mathrm{j}\cdot2\pi}=1
%    \end{cases}\,.
%\end{equation}


%\noindent
%$\mathsf{X}$ --- sample space to which the sequence of signals $x_1, x_2, \dots$ belongs\\
%$\mathsf{Y}$ --- outcome space to which the sequence of the corresponding responces $y_1, y_2, \dots$ belongs \\
%$\mathcal{N}$ --- set of experts, usually natural numbers \\
% $\mathsf{D}$ --- desicion space, to which predictions belong \\
% $ \lambda: \mathsf{D} \times \mathsf{Y} \rightarrow \RR_+$ --- nonnegative loss function \\
%
%\noindent
%$L^i_T = \sum\limits_{t = 1}^T l^i_t$ --- cumulative loss of expert $i$ during the first T steps \\
%$H_T = \sum\limits_{t = 1}^T h_t$ --- master's cumulative loss during the first T steps \\
%$R^i_t = H_T - L^i_T$ --- master's regret relative to the expert $i$
%
%\paragraph{Algorithm}
%
%\noindent



%
%\section{Preparing a manuscript}
%\noindent
%Manuscripts are prepared using \verb'jmlda.sty' style package.
%You are recommended to use \verb'jmlda_rus.bst' and \verb'jmlda_eng.bst' style files for generating bibliography using Bib\TeX.
%
%Visit the \url{http://jmlda.org/?lang=en} website for detailed submission instructions, templates and other information.
%
%Please note that this file must be saved in~\verb'UTF-8' encoding. Where possible select~\verb'UTF-8 without BOM' encoding. 
%To change the encoding please use \verb'Sublime Text' or \verb'Notepad++' text editors.
%
%\section{Structure of the article}
%\noindent
%Divide your article into clearly defined and numbered sections and paragraphs.
%
%\paragraph{Paragraph}
%\noindent
%Sections and paragraphs are numbered and have a brief heading.

%please do not change the name of this section if it is present

%\section{Concluding Remarks}
%This section should provide the summary and explore the significance of the results achieved and list problems not yet solved.
%Results should be clear and concise.

%%%% please specify doi of the cited item if possible, see~\bibitem{article}
%%%% Crossref doi of the item can be retrieved at http://www.crossref.org/guestquery/

\begin{thebibliography}{99}

\bibitem{book}
	\BibAuthor{N.\,Cesa-Bianchi, G.\,Lugosi}. 2006.
	\BibTitle{Prediction, Learning, and Games}.
	Available at: \BibUrl{https://ii.uni.wroc.pl/~lukstafi/pmwiki/uploads/AGT/Prediction_Learning_and_Games.pdf}
	
\bibitem{ebook}
	\BibAuthor{Hyndman,\,R.\,J. \& Athanasopoulos,\,G., 2nd edition}. 2018.
	\BibTitle{Forecasting: Principles and Practice}.
	\BibJournal{OTexts: Melbourne, Australia} .
	Available at: \BibUrl{https://otexts.com/fpp2/}
	
	
\bibitem{vvbook}
	\BibAuthor{V.\,V'yugin}. 2022.
	Matematicheskie osnovy mashinnogo obucheniya i prognozirovaniya	
	[Mathematical Foundations of Machine Learning and Forecasting].
	Available at: \BibUrl{http://iitp.ru/upload/publications/6256/vyugin1.pdf}

\bibitem{article}
	\BibAuthor{V.\,V’yugin, V.\,Trunov}. 2023.
	Prognozirovanie lokal'no statsionarnykh dannykh s ispol'zovaniem predskazanii ekspertnykh strategiy
	[Prediction of Locally Stationary Data Using Prediction with
Expert Advice].
	Available at: \BibUrl{http://www.jip.ru/2023/470-487-2023.pdf}
	
\bibitem{article98}
	\BibAuthor{M.\,Herbster, M.\,Warmuth}. 1998.
	\BibTitle{Tracking the best expert}.
	Available at: \BibUrl{https://link.springer.com/content/pdf/10.1023/A:1007424614876.pdf}
	
\bibitem{article02}
	\BibAuthor{O.\,Bousquet, M.\,Warmuth}. 2002.
	\BibTitle{Tracking a small set of experts by mixing past posteriors}.
	Available at: \BibUrl{https://www.jmlr.org/papers/volume3/bousquet02b/bousquet02b.pdf}
%
%
%\bibitem{webArticle}
%	\BibAuthor{Blaga,~P.\,A.} 2007.
%	Commutative Diagrams with XY-pic II. Frames and Matrices.
%	\BibJournal{PracTEX J.}  4.
%	Available at: \BibUrl{https://tug.org/pracjourn/2007-1/blaga/blaga.pdf}
%    (accessed February 20, 2007).
%
%\bibitem{webResource}
%	XYpic.
%	Available at: \BibUrl{http://akagi.ms.u-tokyo.ac.jp/input9.pdf}
%	(accessed April 09, 2015).
%
%\bibitem{inproceedingsRus}
%	\BibAuthor{Usmanov,~T.\,S., A.\,A.~Gusmanov, I.\,Z.~Mullagalin, R.\,Yu.~Mukhametshina, A.\,N.~Chervyakova, and A.\,V.~Sveshnikov.} 2007.
%	Osobennosti proektirovaniya razrabotki mestorozhdeniy s primeneniem gidrorazryva plasta
%	[Features of the design of field development with the use of hydraulic fracturing].
%	\BibJournal{6th Symposium (International) ``New Energy Saving Subsoil Technologies and the
%	Increasing of the Oil and Gas Impact'' Proceedings}.
%	Moscow:~Publisher. 267--272. (In Russian)
%	   	
%\bibitem{inproceedingsEng}
%    \BibAuthor{Author,~N.} 2009.
%    Paper title.
%    \BibJournal{10th Conference (International) on Any Science Proceedings}.
%    Place of publication: Publisher. 111--122.
%	
%\bibitem{techreport}
%	\BibAuthor{Lambert,~P.} 1993.
%  	\BibTitle{The title of the work}.
%  	Place of publication:~The institution that published.  Report~2.
  	     	
\end{thebibliography}


%
%\titleRus
%    [Шаблон статьи для публикации] % short title for page headings, not necessary if a full title fits the headings
%    {Шаблон статьи для публикации в журнале <<Машинное обучение и анализ данных>>} % full title
%\authorRus
%    [И.\,О.~Автор] % short list of the authors (<= 3) for page headings, is necessary only if the full list does not fit the headings
%    {И.\,О.~Автор, И.\,О.~Соавтор, И.\,О.~Фамилия} % full list of the authors, presented in the table of contetns of the issue
%    [И.\,О.~Автор$^1$, И.\,О.~Соавтор$^2$, И.\,О.~Фамилия$^{1,2}$] % list of the authors presented in the title page of the article, is necessary only if it differs from the full list of the authors in braces, i.e. '{' and '}'
%\thanksRus
%    {Работа выполнена при
%     %частичной
%     финансовой поддержке РФФИ, проекты \No\ \No 00-00-00000 и 00-00-00001.}
%\organizationRus
%    {Московский Физико-Технический Институт}
%\abstractRus
%    {Данный текст является шаблоном статьи, подаваемой для публикации в журнале <<Машинное обучение и анализ данных>>.
%
%    Аннотация описывает основную цель работы,
%    особенности предлагаемого подхода и~основные результаты.
%    Сведения, содержащиеся в заглавии статьи, не должны повторяться в тексте авторского резюме.
%    В аннотации не должно быть ссылок на литературу и, по возможности, формул.
%	
%	Также необходимо представить расширенную структурированную аннотацию на английском языке объемом 200--300 слов.	
%	Английская аннотация может не быть дословным переводом русского текста и должна быть написана хорошим английским языком.
%	
%	В титульном заголовке необходимо указать полный, официально принятый, переводной вариант названия организации.
%	Указывать нужно только ту часть названия, которая относится к понятию юридического лица,
%	не вписывая названий кафедры, лаборатории или другого структурного подразделения внутри организации.
%	Необходимо указать полный юридический адрес, или, как минимум, город и страну.
% 	
% 	При выборе ключевых слов основным критерием является их потенциальная ценность для выражения содержания документа или для его поиска.
%	В качестве ключевых слов могут использоваться термины из названия, аннотации, вступительной и заключительной части текста статьи.
% 	При подборе ключевых слов рекомендуется использовать базовые термины вместе с более сложными, допускается использование повторов и синонимов.
%	Не рекомендуется использование слишком сложных слов, слов в кавычках, слов с запятыми.
%	По возможности следует применять слова в основной форме именительного падежа единственного числа.
%	Рекомендуемое количество ключевых слов~-- 5-7, количество слов внутри ключевой фразы~-- не более 3.
%	
%\bigskip
%\noindent
%\textbf{Ключевые слова}: \emph {ключевое слово; ключевое слово; еще ключевые слова, разделенные <<;>>}
%}
%

%
%\maketitleSecondary
%\Russian
%%%%% please specify doi of the cited item if possible, see~\bibitem{article}
%%%%% Crossref doi of the item can be retrieved at http://www.crossref.org/guestquery/
%\begin{thebibliography}{99}
%\bibitem{book}
%    \BibAuthor{Гуссенс~М., Миттельбах~Ф., Cамарин~А.}
%    \BibTitle{Путеводитель по пакету \LaTeX\ и~его расширению \LaTeXe} / Пер. с англ.~---
%    М.:~Мир, 1999. 606~с.
%    (\BibAuthor{Goossens M., Mittelbach F., Samarin A.}
%     \BibTitle{The \LaTeX\ companion}.~--- 2nd ed.~--- Reading, MA, USA: Addison-Wesley, 1994. 528 p.)
%
%\bibitem{article}
%    \BibAuthor{Загуренко~А.\,Г., Коротовских~В.\,А., Колесников~А.\,А., Тимонов~А.\,В., Кардымов~Д.\,В.}
%    Технико-экономическая оптимизация дизайна гидроразрыва пласта~//
%    \BibJournal{Нефтяное хозяйство}, 2008. Т.~11. \No\,1. С.~54--57.
%	\BibDoi{10.3114/S187007708007}.
%
%\bibitem{webArticle}
%	\BibAuthor{Blaga~P.\,A.}
%	Commutative Diagrams with XY-pic II. Frames and Matrices~//
%	\BibJournal{PracTEX J.}, 2007. Vol.\,4.
%	URL: \BibUrl{https://tug.org/pracjourn/2007-1/blaga/blaga.pdf}.
%
%\bibitem{webResource}
%	XYpic.
%	URL: \BibUrl{http://akagi.ms.u-tokyo.ac.jp/input9.pdf}.
%	
%\bibitem{inproceedingsRus}
%	\BibAuthor{Усманов~Т.\,С., Гусманов~А.\,А., Муллагалин~И.\,З., Мухаметшина~Р.\,Ю., Червякова~А.\,Н., Свешников~А.\,В.}
%	Особенности проектирования разработки месторождений с применением гидроразрыва пласта~//
%	\BibJournal{Труды 6-го Междунар. симп. <<Новые ресурсосберегающие технологии недропользования и повышения нефтегазоотдачи>>}.~---
%	М.:~Издательство, 2007. С.~267--272.
%
%\bibitem{inproceedingsEng}
%    \BibAuthor{Author~N.}
%    Paper title~//
%    \BibJournal{10th Conference (International) on Any Science Proceedings}.~---
%    Place of publication: Publisher, 2009. P.~111--122.
%
%\bibitem{techreport}
%	\BibAuthor{Lambert~P.}
%  	\BibTitle{The title of the work}.
%  	Place of publication:~The institution that published, 1993.  Report~2.
% 	
%\end{thebibliography}


\end{document}
